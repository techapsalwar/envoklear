<IfModule mod_rewrite.c>
    RewriteEngine On

    # Block sensitive files before any redirect
    RewriteCond %{REQUEST_URI} ^/(\.env|\.env\..*|\.git|composer\.(json|lock)|package\.json|yarn\.lock|pnpm-lock\.yaml|phpunit\.xml|artisan|server\.php) [NC]
    RewriteRule ^ - [F,L]

    # Redirect all requests to public folder
    RewriteCond %{REQUEST_URI} !^/public/
    RewriteRule ^(.*)$ /public/$1 [L]
</IfModule>

# Block access to sensitive files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

<FilesMatch "\.(env|env\..*|json|lock|md|xml|yml|yaml|log|sh|sql)$">
    Require all denied
</FilesMatch>

# Block access to sensitive directories
<IfModule mod_rewrite.c>
    RewriteRule ^(app|bootstrap|config|database|resources|routes|storage|tests|vendor)($|/) - [F,L]
</IfModule>
